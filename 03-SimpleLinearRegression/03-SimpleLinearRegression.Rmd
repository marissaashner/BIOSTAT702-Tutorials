---
title: "BIOSTAT702 R Tutorial 3: "
subtitle: "Simple Linear Regression"
author: "Marissa Ashner, PhD"
date: "Last Updated: 2024-08-01"
output: 
  html_document:
    theme: cosmo
    fig_width: 7
    fig_height: 5
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
---

```{css, echo=FALSE}
pre {
  max-height: 300px;
  overflow-y: auto;
}
h1.title{
  font-size: 30px;
  font-weight: bold;
  margin-bottom: 0px;
}
h1 {
  font-size: 20px;
}
h2{
  font-size: 16px;
}
h3.subtitle {
  font-size: 25px;
  font-style: italic;
  margin-top: 3px;
}
h3{
  font-size: 14px;
}
h4{
  font-size: 13px;
}
body, code.r, pre{
  font-size: 12px;
}
```


```{r setup, include=FALSE}
# setting global options for code chunks
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE)
```

This tutorial will follow closely with Chapter 4 in the [textbook](https://bookdown.org/rwnahhas/RMPH/datasumm.html).

# Packages 

The following code loads the packages you need for the tutorial.

```{r, message = FALSE}
## NOTE: If you do not have a package installed, you must install it first
# For example, you can run the following code if you don't have the gtsummary package:
# install.packages("gtsummary")


# for navigating within the R project
library(here)

# for data wrangling 
library(tidyverse)

# for nice-looking tables 
library(gtsummary)
```

# Resources

Below is a list of resources that may be helpful or provide more information on this topic. 

- [Name](website)

# Load Data 

```{r}
# Load Data 
# will be called "nhanes_adult_exam_sub" in your environment 
load(here("data/nhanes1718_adult_fast_sub_rmph.Rdata"))

# rename dataset for convenience 
nhanesf <- nhanes_adult_fast_sub
```

# Continuous Outcome and Continuous Predictor

## Visualize the Data 

From this dataset, we will investigate how the mean fasting glucose varies with waist circumference (a continuous predictor). 

## Visualizing the Distribution of the Outcome 

```{r, message = FALSE}
ggplot(data = nhanesf) + 
  geom_histogram(aes(LBDGLUSI)) + 
  labs(x = "Fasting Glucose (mmol/L)") + 
  geom_vline(xintercept = mean(nhanesf$LBDGLUSI), color = "red")
```

## Visualizing the Relationship between the Predictor and Outcome 

Scatterplots 

# Fitting the Linear Model 

```{r}
fit1 <- lm(LBDGLUSI ~ BMXWAIST, data = nhanesf)
summary(fit1)
```

talk about / show outputs 

## Nice-Looking Summary Table 

```{r}
fit1_table <- fit1 %>%
  tbl_regression(intercept = T,
                 estimate_fun = function(x) style_sigfig(x, digits = 4),
                 pvalue_fun   = function(x) style_pvalue(x, digits = 3),
                 label        = list(BMXWAIST ~ "Waist circumference (cm)")) %>%
  modify_caption("Regression of fasting glucose (mmol/L) on waist circumference")
fit1_table
```

```{r}
#TABLE2 %>%
#  as_flex_table() %>%
#  flextable::save_as_docx(path = "MyTable2.docx")
```

## Centering and Scaling a Continuous Predictor 


# Session information

```{r echo = FALSE, results = 'markup'}
sessionInfo()
```

